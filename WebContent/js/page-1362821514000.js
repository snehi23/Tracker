var helpers={randomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},labAnimation={elements:{buildings:{name:"buildings",x:119,y:184,z:.85},trees:{name:"trees",x:15,y:247,z:.65},windowbg:{name:"windowbg",x:280,y:290,z:0},lab:{name:"sprite-lab",x:355,y:358,z:0,w:99,h:65,framecount:29,loopframe:0},testtubes:{name:"sprite-testtubes",x:272,y:317,z:0,w:104,h:100,framecount:103,loopframe:0,actionframe:48},lightning:{name:"lightning",x:971,y:99,z:1.15},logotext:{name:"logotext",x:308,y:125,z:1.15},pixellab:{name:"lab",x:42,y:271,z:0},discuss:{name:"sprite-discuss",x:1e3,y:500,z:-.5,w:138,h:114,framecount:131,loopframe:0},laptop:{name:"sprite-laptop",x:115,y:405,z:0,w:61,h:197,framecount:38,loopframe:0,actionframe:13},thunder:{name:"sprite-thunder",x:970,y:16,z:1.15,w:108,h:192,framecount:97,loopframe:0,actionframe:23},dog:{name:"sprite-dog",x:1139,y:588,z:-.5,w:91,h:67,framecount:19,loopframe:0,actionframe:11,scale:.8}},stage:null,init:function(){var e=document.getElementById("c"),t=new PxLoader,i=this;e.width=1366,e.height=660,this.stage=new createjs.Stage(e);for(var o in this.elements)this.elements[o].image=t.addImage("/images/lab/"+this.elements[o].name+".png");t.addProgressListener(function(e){i.loadProgress(e)}),t.addCompletionListener(function(){i.loadComplete()}),t.start()},loadProgress:function(e){e.error?console.log("load complete"):e.timeout&&console.log("load timeout")},loadComplete:function(){var e=this;for(var t in this.elements){var i=this.elements[t];if(i.framecount){if(i.actionframe)var o={loop:[0,i.actionframe-1],action:[i.actionframe,i.framecount-1]};else var o={loop:[0,i.framecount-1]};i.spriteSheet=new createjs.SpriteSheet({images:[i.image],frames:{regX:0,regY:0,width:i.w,height:i.h,count:i.framecount},animations:o}),i.bitmap=new createjs.BitmapAnimation(i.spriteSheet),i.bitmap.name=i.name,i.bitmap.snapToPixel=!0,i.bitmap.gotoAndPlay("loop"),i.bitmap.currentFrame=0,this.stage.addChild(i.bitmap)}else i.bitmap=new createjs.Bitmap(i.image),i.bitmap.name=i.name,this.stage.addChild(i.bitmap);i.scale&&(i.bitmap.scaleX=i.scale,i.bitmap.scaleY=i.scale),i.bitmap.x=i.x,i.bitmap.y=i.y}$("#c").css("display","block"),setTimeout(function(){$("#welcome-graphics-container img").css("opacity",0)},50),createjs.Ticker.addListener(this),createjs.Ticker.useRAF=!0,createjs.Ticker.setFPS(15),$(window).scroll(function(){e.adjustForScrolling(),e.stage.tickOnUpdate=!1,e.stage.update(),e.stage.tickOnUpdate=!0})},adjustForScrolling:function(){var e=300,t=$(window).scrollTop()/e,i=60*t;for(var o in this.elements){var n=this.elements[o],a=n.bitmap;a.y=n.y+i*n.z,$("#welcome h2").css({top:-1.8*i}),$("#welcome h3").css({top:-1.8*i})}},doAction:function(e){e.isrunning||(e.isrunning=!0,e.bitmap.gotoAndPlay("action"),e.bitmap.onAnimationEnd=function(t){t.gotoAndPlay("loop"),t.onAnimationEnd=null,e.isrunning=!1})},pause:function(){createjs.Ticker.setPaused(!0)},play:function(){createjs.Ticker.setPaused(!1)},tickcount:0,nextstart:15,tick:function(){if(this.tickcount++,this.adjustForScrolling(),this.tickcount==this.nextstart){var e=helpers.randomInt(0,100);20>e?this.doAction(this.elements.dog):40>e?this.doAction(this.elements.thunder):60>e?this.doAction(this.elements.laptop):90>e&&this.doAction(this.elements.testtubes),this.nextstart=helpers.randomInt(10,30),this.tickcount=0}this.stage.update()}};$(document).ready(function(){function e(e){0==e&&$("#work-button-prev").hide(),e==a-1&&$("#work-button-next").hide(),$("#work-slides-selector li").removeClass("selected"),$("#work-slides-selector li:eq("+e+")").addClass("selected")}function t(e){if(e.node!=r&&e.offset){var t=$(e.node);t.parent(),roughindex=-1*(e.offset%t.width())/t.parent().width(),l=Math.floor(roughindex),c=Math.ceil(roughindex),m=$(".slide-item-overlay:eq("+c+")"),d=$(".slide-item-overlay:eq("+l+")")}if(l!=c){var i=c-roughindex,o=i-1;i=800*i,o=800*o,m.css({webkitTransform:"matrix(1,0,0,1,"+i+",0)",mozTransform:"matrix(1,0,0,1,"+i+",0)",transform:"matrix(1,0,0,1,"+i+",0)"}),d.css({webkitTransform:"matrix(1,0,0,1,"+o+",0)",mozTransform:"matrix(1,0,0,1,"+o+",0)",transform:"matrix(1,0,0,1,"+o+",0)"})}}function i(e){var t=$("#work-details");t.children().hide();var i=$(t.children()[e]);i.css("top",Math.max(($(window).height()-i.height())/3,0)),i.show(),t.fadeTo(0,.01,function(){$(".work-detail-slides-outer").iosSlider("update"),t.fadeTo(300,1)})}var o="Chrome"==BrowserDetect.browser&&BrowserDetect.version>=19||"Safari"==BrowserDetect.browser&&BrowserDetect.version>=5||"Explorer"==BrowserDetect.browser&&BrowserDetect.version>=9||"Firefox"==BrowserDetect.browser&&BrowserDetect.version>=12;o||$("body").addClass("warning-fix"),Modernizr.touch,labAnimation.init(),$("#welcome h2").fitText(1.4),$("#header-menu li a").click(function(e){var t=$(e.target).attr("href");$("html, body").animate({scrollTop:$(t).offset().top-$("header").height()},750,"easeInOutQuart"),e.preventDefault()});var n=-1;$(window).scroll(function(){var e=0,t=$(window).scrollTop();t>=$("#work").position().top-68&&(e=1),t>=$("#about").position().top-68&&(e=2),t>=$("#contact").position().top-68&&(e=3),e!=n&&($("#header-menu li").removeClass("selected"),$("#header-menu li:eq("+e+")").addClass("selected"),n=e)});var a=0,s=1;$(".slide-item-outer").css("display","block"),$("#work-slides #slides-outer").iosSlider({snapToChildren:!0,desktopClickDrag:!0,keyboardControls:!0,infiniteSlider:!1,navSlideSelector:$("#work-slides-selector li"),navPrevSelector:$("#slides-prev"),navNextSelector:$("#slides-next"),onSliderLoaded:function(){a=$(".slide-item-outer").length,$(".slide-item-content img").click(function(e){var t=$(this).closest(".slide-item-outer").index();i(t),e.preventDefault()}),$(".slide-item-learnmore").mousedown(function(){var e=$(this).closest(".slide-item-outer").index();i(e)}),e(0)},onSlideChange:function(t){e(t.currentSlideNumber-1),s=t.currentSlideNumber,$("#slides-prev, #slides-next").css("opacity","1"),1==s&&$("#slides-prev").css("opacity","0"),s==a&&$("#slides-next").css("opacity","0")},onSliderOffsetChanged:function(e){t(e)},onSliderResize:function(){}});var r=null,l=null,c=null,d=null,m=null;$(".work-detail-slides-outer").iosSlider({snapToChildren:!0,desktopClickDrag:!0,keyboardControls:!0,infiniteSlider:!0,onSlideChange:function(e){var t=e.currentSlideNumber-1,i=$(e.sliderContainerObject).parent().find(".work-detail-slides-navselector");i&&(i.find("li").removeClass("selected"),$(i.children()[t]).addClass("selected"))},onSliderLoaded:function(){$(".work-detail-thumb").click(function(){var e=$(this).index()+1,t=$(this).closest(".work-detail-slides-outer");t&&e&&t.iosSlider("goToSlide",e)})}}),$("#work-details").mousedown(function(e){e.target==$(this)[0]&&$(this).hide()}),$("#work-details").hide(),$("#work-details").css({opacity:1}),$(".work-detail-slides-navselector li").click(function(){var e=$(this).index()+1;$(this).closest(".work-detail-item").find(".work-detail-slides-outer").iosSlider("goToSlide",e)}),$(".question-item").has(".more").addClass("hasmore"),$('<span class="prompt">MORE</span>').insertBefore(".question-item .more:first-child"),$(".question-item.hasmore").click(function(){$(this).removeClass("hasmore"),$(this).find(".more").css({opacity:0}).animate({opacity:1},300)}),$("#contact-form").submit(function(){function e(e){$("#contact-form #message").html(e).fadeIn(200).delay(2e3).fadeOut(500)}function t(){$("#contact-form").animate({left:"1000px",opacity:"0"},600,"easeInBack",function(){$("#contact-form").css("opacity",0),$("#contact-sent").fadeIn(400).delay(1600).fadeOut(400),$("#contact-form").css("left","-200px").delay(2e3).animate({left:"0",opacity:"1"},1e3,"easeInQuart")})}var i=$(this).attr("action");return $("#submit").attr("disabled","disabled"),$.post(i,{name:$("#name").val(),email:$("#email").val(),phone:$("#phone").val(),subject:$("#subject").val(),comments:$("#comments").val(),verify:$("#verify").val()},function(i){"SUCCESS"==i?(t(),$("#name").val(""),$("#email").val(""),$("#phone").val(""),$("#subject").val(""),$("#comments").val(""),$("#verify").val("")):e(i),$("#submit").removeAttr("disabled")}),!1})});